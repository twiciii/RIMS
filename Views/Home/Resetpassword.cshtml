@{
    ViewData["Title"] = "Reset Password";
}

<div class="reset-container">
    <h2 class="text-center fw-bold mb-4" style="color:#8CBF3F;">Reset Password</h2>

    <div class="form-group mb-3 position-relative">
        <label for="newPassword" class="form-label fw-semibold">New Password</label>
        <input type="password" id="newPassword" class="form-control" placeholder="Enter new password" required>
        <i class="bi bi-eye-fill" id="toggleNewPassword"
           style="position:absolute; right:15px; top:40px; cursor:pointer; color:gray; font-size:1.2rem;"></i>
    </div>

    <div class="form-group mb-2 position-relative">
        <label for="confirmPassword" class="form-label fw-semibold">Confirm Password</label>
        <input type="password" id="confirmPassword" class="form-control" placeholder="Confirm new password" required>
        <i class="bi bi-eye-fill" id="toggleConfirmPassword"
           style="position:absolute; right:15px; top:40px; cursor:pointer; color:gray; font-size:1.2rem;"></i>
    </div>

    <div id="errorMessage" class="alert alert-danger text-center py-2 mt-3" style="display:none; font-size:14px;"></div>

    <button id="resetBtn" class="btn w-100 mt-3 fw-semibold"
            style="background-color:#8CBF3F; color:white; border:none;">
        Update Password
    </button>

    <div class="modal fade" id="successModal" tabindex="-1" aria-labelledby="successModalLabel" aria-hidden="true">
        <div class="modal-dialog modal-dialog-centered">
            <div class="modal-content text-center p-4">
                <div class="text-success fs-1 mb-2">
                    <i class="bi bi-check-circle-fill"></i>
                </div>
                <h5>Password changed successfully</h5>
                <p class="text-muted mb-3">Please login to your account again.</p>
                <button id="loginNowBtn" class="btn btn-success mt-2 px-4">LOGIN NOW</button>
            </div>
        </div>
    </div>
</div>

<script>
    document.addEventListener("DOMContentLoaded", function () {
        const newPassword = document.getElementById("newPassword");
        const confirmPassword = document.getElementById("confirmPassword");
        const toggleNewPassword = document.getElementById("toggleNewPassword");
        const toggleConfirmPassword = document.getElementById("toggleConfirmPassword");
        const resetBtn = document.getElementById("resetBtn");
        const errorMessage = document.getElementById("errorMessage");
        const successModal = new bootstrap.Modal(document.getElementById('successModal'));

        toggleNewPassword.addEventListener("click", function () {
            const type = newPassword.getAttribute("type") === "password" ? "text" : "password";
            newPassword.setAttribute("type", type);
            this.classList.toggle("bi-eye");
            this.classList.toggle("bi-eye-fill");
        });

        toggleConfirmPassword.addEventListener("click", function () {
            const type = confirmPassword.getAttribute("type") === "password" ? "text" : "password";
            confirmPassword.setAttribute("type", type);
            this.classList.toggle("bi-eye");
            this.classList.toggle("bi-eye-fill");
        });

        resetBtn.addEventListener("click", function () {
            const passwordValue = newPassword.value.trim();
            const confirmValue = confirmPassword.value.trim();

            errorMessage.style.display = "none";

            if (passwordValue.length < 8) {
                errorMessage.textContent = "Password must be at least 8 characters.";
                errorMessage.style.display = "block";
                return;
            }

            if (passwordValue !== confirmValue) {
                errorMessage.textContent = "Passwords do not match.";
                errorMessage.style.display = "block";
                return;
            }

            successModal.show();

            document.getElementById("loginNowBtn").addEventListener("click", function () {
                window.location.href = "/Home/Index";
            });
        });
    });
</script>
