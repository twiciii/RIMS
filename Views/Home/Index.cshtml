@{
    ViewData["Title"] = "Login";
}

<div class="login-container">
    <h3 class="text-center mb-4" style="color:#ADCB7B;">Log In</h3>

    <form>
        <div class="mb-3">
            <label for="email" class="form-label">Email</label>
            <input type="email" class="form-control" id="email" placeholder="Enter email" required>
        </div>

        <div class="mb-3 position-relative">
            <label for="password" class="form-label">Password</label>
            <input type="password" class="form-control" id="loginPassword" placeholder="Enter password" required>
            <i class="bi bi-eye-fill" id="toggleLoginPassword"
               style="position:absolute; right:15px; top:38px; cursor:pointer; color:gray; font-size:1.2rem;"></i>
        </div>

        <div class="mb-3 form-check">
            <input type="checkbox" class="form-check-input" id="remember">
            <label class="form-check-label" for="remember">Remember me</label>
            <a href="#" class="float-end" style="color:#0E4732;" data-bs-toggle="modal" data-bs-target="#passwordResetModal">
                Forgot Password?
            </a>
        </div>

        <div class="modal fade" id="passwordResetModal" tabindex="-1" aria-labelledby="passwordResetLabel" aria-hidden="true">
            <div class="modal-dialog modal-dialog-centered">
                <div class="modal-content" style="border-radius:15px;">
                    <div class="modal-header" style="background-color:#9CCC65; border-top-left-radius:15px; border-top-right-radius:15px;">
                        <h6 class="modal-title text-white" id="passwordResetLabel">Password Reset</h6>
                        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                    </div>

                    <div class="modal-body text-center">
                        <h6 class="fw-bold mb-3">Are you sure you want to reset your account password?</h6>
                        <p style="font-size: 14px; color: #555;">
                            Resetting your password will erase your credentials from the server.
                            Begin the reset process by entering your email below.
                        </p>
                        <input type="email" class="form-control mt-3 mb-3" id="resetEmail" placeholder="Enter Email" required>

                        <div class="d-flex justify-content-end">
                            <button type="button" class="btn btn-secondary me-2" data-bs-dismiss="modal">Cancel</button>
                            <button type="button" class="btn btn-success" id="continueReset">Continue</button>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <button type="submit" class="btn btn-success w-100">LOG IN</button>
        <p class="text-center mt-3">
            Don't have an account?
            <a asp-controller="Home" asp-action="Register" style="color:#0E4732;">Sign Up</a>
        </p>
    </form>
</div>

<div class="dashboard">
    <div class="container">
        <h2>Available Services</h2>
        <div class="services-grid">
            <div class="service-card" onclick="location.href='@Url.Action("Residency", "Certificates")'">
                <h3>Certificate of Residency</h3>
                <p>Request residency certification</p>
            </div>
            <div class="service-card" onclick="location.href='@Url.Action("Indigency", "Certificates")'">
                <h3>Certificate of Indigency</h3>
                <p>Request indigency certification</p>
            </div>
            <div class="service-card" onclick="location.href='@Url.Action("GoodMoral", "Certificates")'">
                <h3>Good Moral Character</h3>
                <p>Request good moral certification</p>
            </div>
            <div class="service-card" onclick="location.href='@Url.Action("SoloParent", "Certificates")'">
                <h3>Solo Parent Certificate</h3>
                <p>Request solo parent certification</p>
            </div>
            <div class="service-card" onclick="location.href='@Url.Action("Clearance", "Certificates")'">
                <h3>Barangay Clearance</h3>
                <p>Request barangay clearance</p>
            </div>
            <div class="service-card" onclick="location.href='@Url.Action("Application", "ID")'">
                <h3>Barangay ID</h3>
                <p>Apply for barangay ID</p>
            </div>
        </div>
    </div>
</div>

<script>
    document.addEventListener("DOMContentLoaded", function () {
        const toggleLoginPassword = document.getElementById('toggleLoginPassword');
        const loginPassword = document.getElementById('loginPassword');

        toggleLoginPassword.addEventListener('click', function () {
            const type = loginPassword.getAttribute('type') === 'password' ? 'text' : 'password';
            loginPassword.setAttribute('type', type);
            this.classList.toggle('bi-eye');
            this.classList.toggle('bi-eye-fill');
        });

        const continueResetBtn = document.getElementById("continueReset");
        const emailInput = document.getElementById("resetEmail");

        continueResetBtn.addEventListener("click", function () {
            const email = emailInput.value.trim();

            if (email === "") {
                alert("Please enter your email.");
                return;
            }

            // Use HTML5 validation to check email format
            if (!emailInput.checkValidity()) {
                alert("Please enter a valid email address.");
                return;
            }

            // Close the modal (safely get or create the Bootstrap modal instance)
            const modalEl = document.getElementById('passwordResetModal');
            const modal = bootstrap.Modal.getInstance(modalEl) || new bootstrap.Modal(modalEl);
            modal.hide();

            // Redirect to Reset Password page
            window.location.href = "/Home/ResetPassword";
        });
    });
</script>